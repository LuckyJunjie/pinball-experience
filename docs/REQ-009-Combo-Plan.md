# REQ-009 Combo å¼€å‘è®¡åˆ’

**éœ€æ±‚:** REQ-009 Combo è¿å‡»ç³»ç»Ÿ  
**é¡¹ç›®:** pinball-experience  
**çŠ¶æ€:** âœ… å·²å®ç°æ ¸å¿ƒé€»è¾‘  
**åˆ›å»º:** 2026-03-01

---

## æ¦‚è¿°

Combo (è¿å‡») ç³»ç»Ÿåœ¨ç©å®¶å¿«é€Ÿè¿ç»­å‡»ä¸­å¤šä¸ªç›®æ ‡æ—¶è§¦å‘ï¼Œæä¾›é¢å¤–çš„åˆ†æ•°åŠ æˆå’Œè§†è§‰åé¦ˆã€‚

### è§¦å‘æ¡ä»¶

- ç©å®¶åœ¨ 2 ç§’æ—¶é—´çª—å£å†…è¿ç»­å‡»ä¸­å¤šä¸ªç›®æ ‡
- Combo è®¡æ•°: x2, x3, x4... (æœ‰ä¸Šé™ï¼Œæœ€å¤§ 10)
- è¶…æ—¶é‡ç½®: 2 ç§’å†…æ— æ–°å‡»ä¸­åˆ™ Combo ä¸­æ–­

### è§†è§‰åé¦ˆ

- è¿å‡»è®¡æ•°å™¨æ˜¾ç¤º (Combo x2, x3, x4...)
- è¿å‡»ç‰¹æ•ˆ (ç¼©æ”¾åŠ¨ç”»)

---

## å®ç°çŠ¶æ€ (2026-03-01)

### âœ… å·²å®Œæˆ

1. **ComboManager.gd** - è¿å‡»ç³»ç»Ÿæ ¸å¿ƒé€»è¾‘
   - `combo_count` è·Ÿè¸ªå½“å‰è¿å‡»æ•°
   - `combo_timer` 2ç§’è¶…æ—¶è®¡æ—¶å™¨
   - `increase_combo()` å…¬å¼€æ–¹æ³•
   - `get_combo_multiplier()` è¿”å›å€ç‡ (combo_count + 1)
   - `force_reset()` å›åˆç»“æŸæ—¶é‡ç½®

2. **ComboManager.tscn** - åœºæ™¯æ–‡ä»¶
   - æ·»åŠ åˆ° Main.tscn

3. **GameManager.gd** - é›†æˆ Combo
   - æ·»åŠ  `combo_manager` å¼•ç”¨
   - ä¿®æ”¹ `add_score()` å…ˆå¢åŠ  Combo å†åº”ç”¨å€ç‡

4. **Main.gd** - è¿æ¥ä¿¡å·
   - è¿æ¥ `game_started` å’Œ `round_lost` åˆ° `combo_manager.force_reset`

5. **UI.gd** - è¿å‡»æ˜¾ç¤º
   - æ·»åŠ  `ComboLabel` å¼•ç”¨
   - è¿æ¥ `combo_increased` å’Œ `combo_reset` ä¿¡å·
   - å®ç° `_update_combo_display()` å¸¦ç¼©æ”¾åŠ¨ç”»

6. **Main.tscn** - åœºæ™¯æ›´æ–°
   - æ·»åŠ  ComboManager èŠ‚ç‚¹
   - æ·»åŠ  ComboLabel åˆ° HUD

---

## è®¾è®¡æ€è·¯

### 1. Combo çŠ¶æ€ç®¡ç†

```gdscript
# ComboManager.gd - ç‹¬ç«‹ç®¡ç†å™¨
var combo_count: int = 0          # å½“å‰è¿å‡»æ•° (0 = æ— è¿å‡»)
var combo_timer: float = 0.0      # å€’è®¡æ—¶è®¡æ—¶å™¨
var max_combo: int = 10           # æœ€å¤§è¿å‡»æ•°ä¸Šé™

const COMBO_TIMEOUT: float = 2.0  # è¿å‡»è¶…æ—¶æ—¶é—´ (ç§’)
```

### 2. ä¿¡å·è®¾è®¡

```gdscript
# æ–°å¢ä¿¡å·
signal combo_increased(new_combo: int)    # è¿å‡»æ•°å¢åŠ 
signal combo_reset()                       # è¿å‡»ä¸­æ–­/é‡ç½®
signal combo_timeout()                     # è¶…æ—¶ä¸­æ–­
```

### 3. åˆ†æ•°å…¬å¼

```
å®é™…å¾—åˆ† = åŸºç¡€åˆ†æ•° Ã— (Combo æ•° + 1)
combo_count=0 â†’ x1 (æ— è¿å‡»)
combo_count=1 â†’ x2 (1æ¬¡è¿å‡»å)
combo_count=2 â†’ x3 (2æ¬¡è¿å‡»å)
```

---

## æ–‡ä»¶å˜æ›´

| æ–‡ä»¶ | æ“ä½œ | çŠ¶æ€ |
|------|------|------|
| `scripts/ComboManager.gd` | ğŸ†• æ–°å»º | âœ… |
| `scenes/ComboManager.tscn` | ğŸ†• æ–°å»º | âœ… |
| `scripts/UI.gd` | âœï¸ æ‰©å±• | âœ… |
| `scripts/Main.gd` | âœï¸ é›†æˆ | âœ… |
| `scripts/GameManager.gd` | âœï¸ é›†æˆ | âœ… |
| `scenes/Main.tscn` | âœï¸ æ›´æ–° | âœ… |

---

## éªŒæ”¶æ ‡å‡†

| æ ‡å‡† | æè¿° | çŠ¶æ€ |
|------|------|------|
| AC-1 | 2 ç§’å†…è¿ç»­å¾—åˆ†æ—¶ Combo æ•°é€’å¢ (x2, x3, x4...) | âœ… |
| AC-2 | 2 ç§’æ— å¾—åˆ†æ—¶ Combo è‡ªåŠ¨é‡ç½®ä¸º 0 | âœ… |
| AC-3 | åˆ†æ•° = åŸºç¡€åˆ†æ•° Ã— (Combo + 1) å€ç‡ | âœ… |
| AC-4 | UI æ˜¾ç¤ºå½“å‰ Combo æ•° | âœ… |
| AC-5 | æœ€å¤§ Combo ä¸Šé™ä¸º 10 | âœ… |

---

## å¾…å®Œæˆ (å¯é€‰)

- [ ] è§†è§‰ç‰¹æ•ˆå¢å¼º (å±å¹•è¾¹ç¼˜å‘å…‰ã€ç²’å­æ•ˆæœ)
- [ ] éŸ³æ•ˆ (è¿å‡»è§¦å‘éŸ³æ•ˆ)
- [ ] å•å…ƒæµ‹è¯•

---

*æ­¤æ–‡æ¡£ç”± subagent åˆ›å»ºç”¨äºåè°ƒ REQ-009 å¼€å‘*
